<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="794pt" height="766pt" viewBox="0.00 0.00 794.30 766.08">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(14.4 751.68)">
<title>G</title>
<polygon fill="white" stroke="none" points="-14.4,14.4 -14.4,-751.68 779.9,-751.68 779.9,14.4 -14.4,14.4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="#dff0d8" stroke="black" d="M128.23,-737.28C128.23,-737.28 64.29,-737.28 64.29,-737.28 58.29,-737.28 52.29,-731.28 52.29,-725.28 52.29,-725.28 52.29,-712.56 52.29,-712.56 52.29,-706.56 58.29,-700.56 64.29,-700.56 64.29,-700.56 128.23,-700.56 128.23,-700.56 134.23,-700.56 140.23,-706.56 140.23,-712.56 140.23,-712.56 140.23,-725.28 140.23,-725.28 140.23,-731.28 134.23,-737.28 128.23,-737.28"/>
<text text-anchor="middle" x="96.26" y="-716.22" font-family="Helvetica,sans-Serif" font-size="9.00">▶️ Start Script</text>
</g>
<!-- setup -->
<g id="node2" class="node">
<title>setup</title>
<path fill="#d9edf7" stroke="black" d="M156,-664.56C156,-664.56 36.51,-664.56 36.51,-664.56 30.51,-664.56 24.51,-658.56 24.51,-652.56 24.51,-652.56 24.51,-618.24 24.51,-618.24 24.51,-612.24 30.51,-606.24 36.51,-606.24 36.51,-606.24 156,-606.24 156,-606.24 162,-606.24 168,-612.24 168,-618.24 168,-618.24 168,-652.56 168,-652.56 168,-658.56 162,-664.56 156,-664.56"/>
<text text-anchor="middle" x="96.26" y="-643.5" font-family="Helvetica,sans-Serif" font-size="9.00">1. Setup Environment</text>
<text text-anchor="middle" x="96.26" y="-632.7" font-family="Helvetica,sans-Serif" font-size="9.00">- Install dependencies</text>
<text text-anchor="middle" x="96.26" y="-621.9" font-family="Helvetica,sans-Serif" font-size="9.00">- Log in to Hugging Face Hub</text>
</g>
<!-- start&#45;&gt;setup -->
<g id="edge1" class="edge">
<title>start-&gt;setup</title>
<path fill="none" stroke="black" d="M96.26,-700.38C96.26,-700.38 96.26,-672.55 96.26,-672.55"/>
<polygon fill="black" stroke="black" points="98.36,-672.55 96.26,-666.55 94.16,-672.55 98.36,-672.55"/>
</g>
<!-- load_data -->
<g id="node3" class="node">
<title>load_data</title>
<path fill="#f2dede" stroke="black" d="M180.52,-570.24C180.52,-570.24 12,-570.24 12,-570.24 6,-570.24 0,-564.24 0,-558.24 0,-558.24 0,-534.72 0,-534.72 0,-528.72 6,-522.72 12,-522.72 12,-522.72 180.52,-522.72 180.52,-522.72 186.52,-522.72 192.52,-528.72 192.52,-534.72 192.52,-534.72 192.52,-558.24 192.52,-558.24 192.52,-564.24 186.52,-570.24 180.52,-570.24"/>
<text text-anchor="middle" x="96.26" y="-549.18" font-family="Helvetica,sans-Serif" font-size="9.00">2. Load Dataset</text>
<text text-anchor="middle" x="96.26" y="-538.38" font-family="Helvetica,sans-Serif" font-size="9.00">User uploads teacher-generated .jsonl file</text>
</g>
<!-- setup&#45;&gt;load_data -->
<g id="edge2" class="edge">
<title>setup-&gt;load_data</title>
<path fill="none" stroke="black" d="M96.26,-605.79C96.26,-605.79 96.26,-578.15 96.26,-578.15"/>
<polygon fill="black" stroke="black" points="98.36,-578.15 96.26,-572.15 94.16,-578.15 98.36,-578.15"/>
</g>
<!-- format_data -->
<g id="node4" class="node">
<title>format_data</title>
<path fill="#d9edf7" stroke="black" d="M357.25,-570.24C357.25,-570.24 233.27,-570.24 233.27,-570.24 227.27,-570.24 221.27,-564.24 221.27,-558.24 221.27,-558.24 221.27,-534.72 221.27,-534.72 221.27,-528.72 227.27,-522.72 233.27,-522.72 233.27,-522.72 357.25,-522.72 357.25,-522.72 363.25,-522.72 369.25,-528.72 369.25,-534.72 369.25,-534.72 369.25,-558.24 369.25,-558.24 369.25,-564.24 363.25,-570.24 357.25,-570.24"/>
<text text-anchor="middle" x="295.26" y="-549.18" font-family="Helvetica,sans-Serif" font-size="9.00">3. Format Examples</text>
<text text-anchor="middle" x="295.26" y="-538.38" font-family="Helvetica,sans-Serif" font-size="9.00">Wrap in Llama 3 chat template</text>
</g>
<!-- load_data&#45;&gt;format_data -->
<g id="edge3" class="edge">
<title>load_data-&gt;format_data</title>
<path fill="none" stroke="black" d="M192.84,-546.48C192.84,-546.48 213.32,-546.48 213.32,-546.48"/>
<polygon fill="black" stroke="black" points="213.32,-548.58 219.32,-546.48 213.32,-544.38 213.32,-548.58"/>
</g>
<!-- tokenize_data -->
<g id="node5" class="node">
<title>tokenize_data</title>
<path fill="#d9edf7" stroke="black" d="M357.88,-486.72C357.88,-486.72 232.64,-486.72 232.64,-486.72 226.64,-486.72 220.64,-480.72 220.64,-474.72 220.64,-474.72 220.64,-451.2 220.64,-451.2 220.64,-445.2 226.64,-439.2 232.64,-439.2 232.64,-439.2 357.88,-439.2 357.88,-439.2 363.88,-439.2 369.88,-445.2 369.88,-451.2 369.88,-451.2 369.88,-474.72 369.88,-474.72 369.88,-480.72 363.88,-486.72 357.88,-486.72"/>
<text text-anchor="middle" x="295.26" y="-465.66" font-family="Helvetica,sans-Serif" font-size="9.00">4. Tokenize Dataset</text>
<text text-anchor="middle" x="295.26" y="-454.86" font-family="Helvetica,sans-Serif" font-size="9.00">max_length=8192 (full context)</text>
</g>
<!-- format_data&#45;&gt;tokenize_data -->
<g id="edge4" class="edge">
<title>format_data-&gt;tokenize_data</title>
<path fill="none" stroke="black" d="M295.26,-522.32C295.26,-522.32 295.26,-494.58 295.26,-494.58"/>
<polygon fill="black" stroke="black" points="297.36,-494.58 295.26,-488.58 293.16,-494.58 297.36,-494.58"/>
</g>
<!-- load_model -->
<g id="node6" class="node">
<title>load_model</title>
<path fill="#d9edf7" stroke="black" d="M372.02,-403.2C372.02,-403.2 218.5,-403.2 218.5,-403.2 212.5,-403.2 206.5,-397.2 206.5,-391.2 206.5,-391.2 206.5,-356.88 206.5,-356.88 206.5,-350.88 212.5,-344.88 218.5,-344.88 218.5,-344.88 372.02,-344.88 372.02,-344.88 378.02,-344.88 384.02,-350.88 384.02,-356.88 384.02,-356.88 384.02,-391.2 384.02,-391.2 384.02,-397.2 378.02,-403.2 372.02,-403.2"/>
<text text-anchor="middle" x="295.26" y="-382.14" font-family="Helvetica,sans-Serif" font-size="9.00">5. Load Base Model with Quantization</text>
<text text-anchor="middle" x="295.26" y="-371.34" font-family="Helvetica,sans-Serif" font-size="9.00">- Llama-3-8B-Instruct 4-bit nf4</text>
<text text-anchor="middle" x="295.26" y="-360.54" font-family="Helvetica,sans-Serif" font-size="9.00">- device_map={'':0} to fix conflicts</text>
</g>
<!-- tokenize_data&#45;&gt;load_model -->
<g id="edge5" class="edge">
<title>tokenize_data-&gt;load_model</title>
<path fill="none" stroke="black" d="M295.26,-439.13C295.26,-439.13 295.26,-411.17 295.26,-411.17"/>
<polygon fill="black" stroke="black" points="297.36,-411.17 295.26,-405.17 293.16,-411.17 297.36,-411.17"/>
</g>
<!-- apply_lora -->
<g id="node7" class="node">
<title>apply_lora</title>
<path fill="#d9edf7" stroke="black" d="M535.49,-403.2C535.49,-403.2 425.03,-403.2 425.03,-403.2 419.03,-403.2 413.03,-397.2 413.03,-391.2 413.03,-391.2 413.03,-356.88 413.03,-356.88 413.03,-350.88 419.03,-344.88 425.03,-344.88 425.03,-344.88 535.49,-344.88 535.49,-344.88 541.49,-344.88 547.49,-350.88 547.49,-356.88 547.49,-356.88 547.49,-391.2 547.49,-391.2 547.49,-397.2 541.49,-403.2 535.49,-403.2"/>
<text text-anchor="middle" x="480.26" y="-382.14" font-family="Helvetica,sans-Serif" font-size="9.00">6. Apply LoRA Adapters</text>
<text text-anchor="middle" x="480.26" y="-371.34" font-family="Helvetica,sans-Serif" font-size="9.00">- Create config (r=32)</text>
<text text-anchor="middle" x="480.26" y="-360.54" font-family="Helvetica,sans-Serif" font-size="9.00">- Inject adapters with PEFT</text>
</g>
<!-- load_model&#45;&gt;apply_lora -->
<g id="edge6" class="edge">
<title>load_model-&gt;apply_lora</title>
<path fill="none" stroke="black" d="M384.51,-374.04C384.51,-374.04 405.28,-374.04 405.28,-374.04"/>
<polygon fill="black" stroke="black" points="405.28,-376.14 411.28,-374.04 405.28,-371.94 405.28,-376.14"/>
</g>
<!-- training_args -->
<g id="node8" class="node">
<title>training_args</title>
<path fill="#d9edf7" stroke="black" d="M566.02,-308.88C566.02,-308.88 394.49,-308.88 394.49,-308.88 388.49,-308.88 382.49,-302.88 382.49,-296.88 382.49,-296.88 382.49,-262.56 382.49,-262.56 382.49,-256.56 388.49,-250.56 394.49,-250.56 394.49,-250.56 566.02,-250.56 566.02,-250.56 572.02,-250.56 578.02,-256.56 578.02,-262.56 578.02,-262.56 578.02,-296.88 578.02,-296.88 578.02,-302.88 572.02,-308.88 566.02,-308.88"/>
<text text-anchor="middle" x="480.26" y="-287.82" font-family="Helvetica,sans-Serif" font-size="9.00">7. Define Training Args</text>
<text text-anchor="middle" x="480.26" y="-277.02" font-family="Helvetica,sans-Serif" font-size="9.00">- Epochs, batch size, LR</text>
<text text-anchor="middle" x="480.26" y="-266.22" font-family="Helvetica,sans-Serif" font-size="9.00">- A100 settings (bf16, paged_adamw_8bit)</text>
</g>
<!-- apply_lora&#45;&gt;training_args -->
<g id="edge7" class="edge">
<title>apply_lora-&gt;training_args</title>
<path fill="none" stroke="black" d="M480.26,-344.46C480.26,-344.46 480.26,-316.71 480.26,-316.71"/>
<polygon fill="black" stroke="black" points="482.36,-316.71 480.26,-310.71 478.16,-316.71 482.36,-316.71"/>
</g>
<!-- init_trainer -->
<g id="node9" class="node">
<title>init_trainer</title>
<path fill="#d9edf7" stroke="black" d="M753.5,-303.48C753.5,-303.48 619.01,-303.48 619.01,-303.48 613.01,-303.48 607.01,-297.48 607.01,-291.48 607.01,-291.48 607.01,-267.96 607.01,-267.96 607.01,-261.96 613.01,-255.96 619.01,-255.96 619.01,-255.96 753.5,-255.96 753.5,-255.96 759.5,-255.96 765.5,-261.96 765.5,-267.96 765.5,-267.96 765.5,-291.48 765.5,-291.48 765.5,-297.48 759.5,-303.48 753.5,-303.48"/>
<text text-anchor="middle" x="686.26" y="-282.42" font-family="Helvetica,sans-Serif" font-size="9.00">8. Initialize Hugging Face Trainer</text>
<text text-anchor="middle" x="686.26" y="-271.62" font-family="Helvetica,sans-Serif" font-size="9.00">Combine components for training</text>
</g>
<!-- training_args&#45;&gt;init_trainer -->
<g id="edge8" class="edge">
<title>training_args-&gt;init_trainer</title>
<path fill="none" stroke="black" d="M578.43,-279.72C578.43,-279.72 599.05,-279.72 599.05,-279.72"/>
<polygon fill="black" stroke="black" points="599.05,-281.82 605.05,-279.72 599.05,-277.62 599.05,-281.82"/>
</g>
<!-- execute_training -->
<g id="node10" class="node">
<title>execute_training</title>
<path fill="#e8f5e9" stroke="black" d="M740.47,-214.56C740.47,-214.56 632.05,-214.56 632.05,-214.56 626.05,-214.56 620.05,-208.56 620.05,-202.56 620.05,-202.56 620.05,-168.24 620.05,-168.24 620.05,-162.24 626.05,-156.24 632.05,-156.24 632.05,-156.24 740.47,-156.24 740.47,-156.24 746.47,-156.24 752.47,-162.24 752.47,-168.24 752.47,-168.24 752.47,-202.56 752.47,-202.56 752.47,-208.56 746.47,-214.56 740.47,-214.56"/>
<text text-anchor="middle" x="686.26" y="-193.5" font-family="Helvetica,sans-Serif" font-size="9.00" fill="#3c763d">9. Execute Fine-Tuning</text>
<text text-anchor="middle" x="686.26" y="-182.7" font-family="Helvetica,sans-Serif" font-size="9.00" fill="#3c763d">(trainer.train())</text>
<text text-anchor="middle" x="686.26" y="-171.9" font-family="Helvetica,sans-Serif" font-size="9.00" fill="#3c763d">The 'Student' model learns</text>
</g>
<!-- init_trainer&#45;&gt;execute_training -->
<g id="edge9" class="edge">
<title>init_trainer-&gt;execute_training</title>
<path fill="none" stroke="black" d="M686.26,-255.92C686.26,-255.92 686.26,-222.45 686.26,-222.45"/>
<polygon fill="black" stroke="black" points="688.36,-222.45 686.26,-216.45 684.16,-222.45 688.36,-222.45"/>
</g>
<!-- save_model -->
<g id="node11" class="node">
<title>save_model</title>
<path fill="#d9edf7" stroke="black" d="M738.5,-120.24C738.5,-120.24 634.02,-120.24 634.02,-120.24 628.02,-120.24 622.02,-114.24 622.02,-108.24 622.02,-108.24 622.02,-84.72 622.02,-84.72 622.02,-78.72 628.02,-72.72 634.02,-72.72 634.02,-72.72 738.5,-72.72 738.5,-72.72 744.5,-72.72 750.5,-78.72 750.5,-84.72 750.5,-84.72 750.5,-108.24 750.5,-108.24 750.5,-114.24 744.5,-120.24 738.5,-120.24"/>
<text text-anchor="middle" x="686.26" y="-99.18" font-family="Helvetica,sans-Serif" font-size="9.00">10. Save Trained Adapter</text>
<text text-anchor="middle" x="686.26" y="-88.38" font-family="Helvetica,sans-Serif" font-size="9.00">LoRA weights saved</text>
</g>
<!-- execute_training&#45;&gt;save_model -->
<g id="edge10" class="edge">
<title>execute_training-&gt;save_model</title>
<path fill="none" stroke="black" d="M686.26,-155.79C686.26,-155.79 686.26,-128.15 686.26,-128.15"/>
<polygon fill="black" stroke="black" points="688.36,-128.15 686.26,-122.15 684.16,-128.15 688.36,-128.15"/>
</g>
<!-- end -->
<g id="node12" class="node">
<title>end</title>
<path fill="#dff0d8" stroke="black" d="M703.98,-36.72C703.98,-36.72 668.54,-36.72 668.54,-36.72 662.54,-36.72 656.54,-30.72 656.54,-24.72 656.54,-24.72 656.54,-12 656.54,-12 656.54,-6 662.54,0 668.54,0 668.54,0 703.98,0 703.98,0 709.98,0 715.98,-6 715.98,-12 715.98,-12 715.98,-24.72 715.98,-24.72 715.98,-30.72 709.98,-36.72 703.98,-36.72"/>
<text text-anchor="middle" x="686.26" y="-15.66" font-family="Helvetica,sans-Serif" font-size="9.00">⏹️ End</text>
</g>
<!-- save_model&#45;&gt;end -->
<g id="edge11" class="edge">
<title>save_model-&gt;end</title>
<path fill="none" stroke="black" d="M686.26,-72.62C686.26,-72.62 686.26,-44.64 686.26,-44.64"/>
<polygon fill="black" stroke="black" points="688.36,-44.64 686.26,-38.64 684.16,-44.64 688.36,-44.64"/>
</g>
</g>
</svg>